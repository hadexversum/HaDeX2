<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Data processing • HaDeX</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Data processing">
<meta property="og:description" content="HaDeX">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">HaDeX</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/HaDeX.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/datafiles.html">Data processing</a>
    </li>
    <li>
      <a href="../articles/mass_comparison.html">Mass calculation</a>
    </li>
    <li>
      <a href="../articles/transformation.html">Data aggregation</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Data processing</h1>
            
      
      
      <div class="hidden name"><code>datafiles.Rmd</code></div>

    </div>

    
    
<!-- Currently, HaDeX is limited to the `cluster` file from DynamX 3.0 or 2.0 and `tables` file from HDeXaminer. Each data file type needs a different way of processing, as explained below. -->
<p>Currently, HaDeX is limited to the <code>cluster</code> file from DynamX 3.0 or 2.0. Below we explain how the data file is processed.</p>
<div id="processing-data-from-dynamx" class="section level2">
<h2 class="hasAnchor">
<a href="#processing-data-from-dynamx" class="anchor"></a>Processing data from DynamX</h2>
<p>Let’s investigate how the data processing of the <code>cluster</code> file from DynamX is conducted on the example file from the package.</p>
<div id="differences-between-files" class="section level3">
<h3 class="hasAnchor">
<a href="#differences-between-files" class="anchor"></a>Differences between files</h3>
<p>What is the difference between <code>cluster</code> files from DynamX 3.0 and 2.0? The datafiles from DynamX 2.0 don’t include <code>Modification</code> and <code>Fragment</code> columns. The variations of the experiment were limited, while the DynamX 2.0 was the latest version.</p>
</div>
<div id="initial-processing-of-the-data" class="section level3">
<h3 class="hasAnchor">
<a href="#initial-processing-of-the-data" class="anchor"></a>Initial processing of the data</h3>
<p>Let’s start with a glimpse of the datafile.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">HaDeX</span><span class="op">)</span>
<span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_hdx.html">read_hdx</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"HaDeX"</span>, <span class="st">"HaDeX/data/KD_180110_CD160_HVEM.csv"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fl">10</span><span class="op">)</span></code></pre></div>
<pre><code>##      Protein Start End        Sequence Modification Fragment MaxUptake      MHP
##  1: db_CD160     1  15 INITSSASQEGTRLN           NA       NA        14 1590.808
##  2: db_CD160     1  15 INITSSASQEGTRLN           NA       NA        14 1590.808
##  3: db_CD160     1  15 INITSSASQEGTRLN           NA       NA        14 1590.808
##  4: db_CD160     1  15 INITSSASQEGTRLN           NA       NA        14 1590.808
##  5: db_CD160     1  15 INITSSASQEGTRLN           NA       NA        14 1590.808
##  6: db_CD160     1  15 INITSSASQEGTRLN           NA       NA        14 1590.808
##  7: db_CD160     1  15 INITSSASQEGTRLN           NA       NA        14 1590.808
##  8: db_CD160     1  15 INITSSASQEGTRLN           NA       NA        14 1590.808
##  9: db_CD160     1  15 INITSSASQEGTRLN           NA       NA        14 1590.808
## 10: db_CD160     1  15 INITSSASQEGTRLN           NA       NA        14 1590.808
##     State Exposure                    File z       RT  Inten    Center
##  1: CD160    0.000 KD_160527_CD160_sekw_05 1 3.232479   6592 1591.2584
##  2: CD160    0.000 KD_160527_CD160_sekw_05 2 3.238079 394066  796.3552
##  3: CD160    0.000 KD_160527_CD160_sekw_05 3 3.238759 173526  531.2633
##  4: CD160    0.001   KD_160527_CD160_IN_01 2 3.258598 232221  796.3634
##  5: CD160    0.001   KD_160527_CD160_IN_01 3 3.256844 110675  531.2849
##  6: CD160    0.167  KD_160530_CD160_10s_01 2 3.262774  99894  800.3610
##  7: CD160    0.167  KD_160530_CD160_10s_02 2 3.264558 117541  800.3852
##  8: CD160    0.167  KD_160530_CD160_10s_03 2 3.263795  90562  800.3682
##  9: CD160    0.167  KD_160530_CD160_10s_04 2 3.273656  66131  800.4242
## 10: CD160    1.000 KD_160530_CD160_1min_01 2 3.262300 109301  800.7878</code></pre>
<p>As you can see, the data file has a very specific structure and is not informative yet. In the file, we have <code>m/z</code> values for each <code>z</code> value (charge) for each time point for each state of each peptide, repeated as many times as measurement was repeated (each measurement should be repeated at least three times).</p>
<!-- The process of measurement and the basics of HDX experiment is described in `Basics of the HDX-MS` article. -->
<p>Our aim is to have one result with an uncertainty of the measurement per each peptide in each biological state in each measured time point - data in this format allows further calculations, e.q. calculating deuterium uptake values.</p>
<p>For a better understanding of the process of aggregating the data, see the <code>Data aggregation</code> article.</p>
<p>Within each replicate of the measurement (we recognize each replicate by the <code>File</code> value), the <code>m/z</code> values are provided for each possible <code>z</code> value. The <code>m/z</code> values are in the <code>Center</code> column, as it is a geometrical centroid calculated from the isotopic envelope. Firstly, we have to calculate the mass value, measured experimentally:</p>
<p><span class="math display">\[expMass = z \times (Center-protonMass)\tag{1}\]</span> <!-- The value is reduced by ... because ... --></p>
<p>To aggregate data from different <code>z</code> values, we have to calculate the mean mass weighted by intensity. Additional information about this step and how the weighted mean impacts the results can be found in <code>Mass calculation</code> article.</p>
<p><span class="math display">\[aggMass = \frac{1}{N}\sum_{k = 1}^{N}Inten_k{\cdot}pepMass_k\tag{2}\]</span>.</p>
<p>Where:</p>
<ul>
<li>
<span class="math inline">\(aggMass\)</span> - mass of the peptide [Da], average from replicates,</li>
<li>
<span class="math inline">\(Inten_k\)</span> - intensity of the measurement,</li>
<li>
<span class="math inline">\(pepMass\)</span> - mass of the peptide, calculated using Equation 1.</li>
</ul>
<p>As we use the aggregated result from the replicates, we need to calculate an uncertainty associated with the measurement. We use the mean value as the final result, so we need to calculate error as a standard deviation of the mean, according to the Equation 3:</p>
<p><span class="math display">\[u(\vec{x}) = \sqrt{\frac{ \sum_{i=1}^n \left( x_{i} - \overline{x} \right)^2}{n(n-1)}}\tag{3}\]</span>.</p>
<p>Where:</p>
<ul>
<li>
<span class="math inline">\(x_{i}\)</span> - measured value from a replicate,</li>
<li>
<span class="math inline">\(\overline{x}\)</span> - mean value from all of the replicates,</li>
<li>
<span class="math inline">\(n\)</span> - number of replicates.</li>
</ul>
<p>Now we have the format we want for further calculations.</p>
</div>
<div id="calculation-of-the-deuterium-uptake" class="section level3">
<h3 class="hasAnchor">
<a href="#calculation-of-the-deuterium-uptake" class="anchor"></a>Calculation of the deuterium uptake</h3>
<p>HaDeX package provides the calculated values in different forms. All of them are provided with associated uncertainty of the measurement. All of the uncertainties are derived from the formula - the Law of propagation of uncertainty:</p>
<p><span class="math display">\[u_{c}(y) = \sqrt{\sum_{k} \left[ \frac{\partial y}{\partial x_{k}} u(x_{k}) \right]^2}\]</span></p>
<div id="deuterium-uptake" class="section level4">
<h4 class="hasAnchor">
<a href="#deuterium-uptake" class="anchor"></a>Deuterium uptake</h4>
<p>Deuterium uptake is the increase of the mass of the peptide in time <span class="math inline">\(t\)</span>. The minimal exchange control <span class="math inline">\(m_{t_0}\)</span> is mass measured directly after adding the buffer (before the start of the exchange), and <span class="math inline">\(m_t\)</span> is the mass measured in chosen time point <span class="math inline">\(t\)</span>. The value is in Daltons [Da].</p>
<p><span class="math display">\[D = m_{t} - m_{t_0}\]</span> The uncertainty associated with deuterium uptake [Da] (based on equation 3):</p>
<p><span class="math display">\[u_c(D) = \sqrt{u(m_t)^2 + u(m_{t_0})^2}\]</span></p>
</div>
<div id="fractional-deuterium-uptake" class="section level4">
<h4 class="hasAnchor">
<a href="#fractional-deuterium-uptake" class="anchor"></a>Fractional deuterium uptake</h4>
<p>Fractional deuterium uptake is the ratio of the increase of the mass in time <span class="math inline">\(t\)</span> to the maximal exchange control. The maximal exchange control <span class="math inline">\(m_{t_{100}}\)</span> is measured after a long time (chosen by the experimenter, usually 1440 min = 24 h). It is assumed that after this long time, the exchange is finished. The minimal exchange control <span class="math inline">\(m_{t_0}\)</span> is mass measured directly after adding the buffer (before the start of the exchange), and <span class="math inline">\(m_t\)</span> is the mass measured in chosen time point <span class="math inline">\(t\)</span>. This value is a percentage value [%].</p>
<p><span class="math display">\[D_{frac} = \frac{m_{t} - m_{t_0}}{m_{t_{100}} - m_{t_0}}\]</span></p>
<p>The uncertainty associated with fractional deuterium uptake [%] (based on equation 3):</p>
<p><span class="math display">\[u_{c}(D_{frac}) = \sqrt{ \left[ 
\frac{1}{m_{t_{100}}-m_{t_0}} u(m_{t}) \right]^2 + 
\left[ \frac{m_{t} - m_{t_{100}}}{(m_{t_{100}}-m_{t_0})^2} u(m_{t_0}) \right]^2 + 
\left[ \frac{m_{t_0} - m_{t}}{(m_{t_{100}}-m_{t_0})^2} u (m_{t_{100}}) \right]^2}\]</span></p>
</div>
<div id="theoretical-deuterium-uptake" class="section level4">
<h4 class="hasAnchor">
<a href="#theoretical-deuterium-uptake" class="anchor"></a>Theoretical deuterium uptake</h4>
<p>Theoretical deuterium uptake is the increase of mass in time <span class="math inline">\(t\)</span> compared with the theoretical value of the peptide mass without any exchange (<span class="math inline">\(MHP\)</span> - a mass of the singly charged monoisotopic molecular ion), and <span class="math inline">\(m_t\)</span> is the mass measured in chosen time point <span class="math inline">\(t\)</span>. This value is in daltons [Da]:</p>
<p><span class="math display">\[D_{theo} = m_{t} - MHP\]</span></p>
<p>The uncertainty associated with theoretical deuterium uptake [Da] (the <span class="math inline">\(MHP\)</span> value is a constant without measurement uncertainty - based on the equation 3):</p>
<p><span class="math display">\[u(D_{theo}) = u(m_t)\]</span></p>
</div>
<div id="theoretical-fractional-deuterium-uptake" class="section level4">
<h4 class="hasAnchor">
<a href="#theoretical-fractional-deuterium-uptake" class="anchor"></a>Theoretical fractional deuterium uptake</h4>
<p>Theoretical fractional deuterium uptake is the ratio of the increase of mass in time <span class="math inline">\(t\)</span> compared with a theoretical value of the mass of the peptide without any exchange to the possible theoretical increase of the mass, based on the maximal potential uptake of the peptide (based on the peptide sequence). This value is a percentage value [%].</p>
<p><span class="math display">\[D_{theo, frac} = \frac{m_{t}-MHP}{MaxUptake \times protonMass}\]</span></p>
<p>The uncertainty associated with theoretical fractional deuterium uptake [%] (based on the equation 3):</p>
<p><span class="math display">\[u(D_{theo, frac}) = \left|\frac{1}{MaxUptake \times protonMass} u(D_{t}) \right|\]</span></p>
</div>
<div id="differential-values" class="section level4">
<h4 class="hasAnchor">
<a href="#differential-values" class="anchor"></a>Differential values</h4>
<p>Differential value is the way to see how the deuterium uptake differs between two biological states. It allows seeing if the possible difference is statistically important (more information below). This value is calculated as the difference between the previously described (in a chosen form) deuterium uptake of the first and second states.</p>
<p><span class="math display">\[diff = D_{1} - D_{2}\]</span> The uncertainty associated with the difference of deuterium uptake (based on the equation 3):</p>
<p><span class="math display">\[u_{c}(diff) = \sqrt{u(D_{1})^2 + u(D_{2})^2}\]</span></p>
<p>The convenient way to present results calculated as described is the comparison plot and differential plot (Woods’ plot).</p>
</div>
</div>
<div id="additional-information" class="section level3">
<h3 class="hasAnchor">
<a href="#additional-information" class="anchor"></a>Additional information</h3>
<p>If the file contains modified peptides - the value from column <code>Modification</code> is added to the value from column <code>State</code> and is treated as a new biological state. The further aspects of the analysis are the same as for non-modified peptides.</p>
<!-- ## Processing data from HDeXaminer -->
<!-- TO BE WRITTEN -->
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Weronika Puchala, Michal Burdukiewicz.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
