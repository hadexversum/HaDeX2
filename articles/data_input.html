<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Importing data â€¢ HaDeX</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Importing data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">HaDeX</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/data_input.html">Importing data</a></li>
    <li><a class="dropdown-item" href="../articles/datafiles.html">Calculations</a></li>
    <li><a class="dropdown-item" href="../articles/glossary.html">Glossary</a></li>
    <li><a class="dropdown-item" href="../articles/mass_comparison.html">Mass calculation</a></li>
    <li><a class="dropdown-item" href="../articles/quality_control.html">Quality control</a></li>
    <li><a class="dropdown-item" href="../articles/transformation.html">Data aggregation</a></li>
    <li><a class="dropdown-item" href="../articles/usage.html">Code usage</a></li>
    <li><a class="dropdown-item" href="../articles/visualization.html">Data visualization</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Importing data</h1>
            
      

      <div class="d-none name"><code>data_input.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://hadexversum.github.io/HaDeX2/">HaDeX</a></span><span class="op">)</span></span></code></pre></div>
<p>Although the HaDeX application accepts only csv file exported from
DynamX in <code>cluster</code> format, it is not impossible to use HaDeX
package with other formats. Here, we present a little guide to mocking
data.</p>
<p>In this article, we focus on processing on the file so it could be
accepted into HaDeX workflow. We do not discuss the content of the file,
without minor comment addressing already calculated uptake data.</p>
<p><em>Keep in mind that this guide is based on the limited amount of
file types from popular vendors. As there are many formats and local
custom in labeling the data, this article should be treated as a hint
how to start, and not finite tutorial. The user needs to be careful and
react accordingly. In case of any doubt, feel free to contact us, we
will be glad to help!</em></p>
<p>The best way to check if the file is suitable for the application is
load in (using e.q. web-server) and see the file status. If the file is
in wrong format, there should be appropriate message.</p>
<p>The main function for data import is <code><a href="../reference/read_hdx.html">HaDeX::read_hdx()</a></code>
function.</p>
<div class="section level2">
<h2 id="dynamx-cluster-file">DynamX cluster file<a class="anchor" aria-label="anchor" href="#dynamx-cluster-file"></a>
</h2>
<p>This is the preferable file format, that does not need any
processing. The required columns are:</p>
<pre><code><span><span class="co">#&gt;  [1] "Protein"      "Start"        "End"          "Sequence"     "Modification"</span></span>
<span><span class="co">#&gt;  [6] "Fragment"     "MaxUptake"    "MHP"          "State"        "Exposure"    </span></span>
<span><span class="co">#&gt; [11] "File"         "z"            "RT"           "Inten"        "Center"</span></span></code></pre>
<p>If the file have all required columns, it should be accepted by the
<code><a href="../reference/read_hdx.html">HaDeX::read_hdx()</a></code> function.</p>
</div>
<div class="section level2">
<h2 id="dynamx-state-file">DynamX state file<a class="anchor" aria-label="anchor" href="#dynamx-state-file"></a>
</h2>
<p>If the user already have an exported file from DynamX in
<code>state</code> format, we assume they have an access to DynamX and
we recommend them to export file in <code>cluster</code> format to avoid
any data processing. However, if this is impossible, we present how to
mock missing information.</p>
<pre><code><span><span class="co">#&gt;  [1] "Protein"      "Start"        "End"          "Sequence"     "Modification"</span></span>
<span><span class="co">#&gt;  [6] "Fragment"     "MaxUptake"    "MHP"          "State"        "Exposure"    </span></span>
<span><span class="co">#&gt; [11] "Center"       "Center SD"    "Uptake"       "Uptake SD"    "RT"          </span></span>
<span><span class="co">#&gt; [16] "RT SD"</span></span></code></pre>
<p>To go from here to desired format, there are some action needed:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">datafile</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat</span> <span class="op">%&gt;%</span></span>
<span>    <span class="co"># mock columns</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span>z <span class="op">=</span> <span class="fl">1</span>, </span>
<span>           Inten <span class="op">=</span> <span class="fl">1</span>, </span>
<span>           File <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span>    <span class="co"># exclude unused columns</span></span>
<span>    <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">Uptake</span>, <span class="op">-</span><span class="va">`Uptake SD`</span>, <span class="op">-</span><span class="va">`Center SD`</span>, <span class="op">-</span><span class="va">`RT SD`</span><span class="op">)</span></span></code></pre></div>
<p>Then, save the file and use it in the application.</p>
<p>Other way is to use already made uptake calculations and use the
uptake data directly in the workflow:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">kin_dat</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op">%&gt;%</span></span>
<span>    <span class="co"># select only one state </span></span>
<span>    <span class="co"># exclude measurement without calculated uptake</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">State</span> <span class="op">==</span> <span class="va">state</span>,</span>
<span>           <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Uptake</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="co"># rename to used convention </span></span>
<span>    <span class="fu">rename</span><span class="op">(</span>deut_uptake <span class="op">=</span> <span class="va">Uptake</span>,</span>
<span>           err_deut_uptake <span class="op">=</span> <span class="va">`Uptake SD`</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="co"># exclude unused columns</span></span>
<span>    <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">Center</span>, <span class="op">-</span><span class="va">`Center SD`</span>, <span class="op">-</span><span class="va">RT</span>, <span class="op">-</span><span class="va">`RT SD`</span>, <span class="op">-</span><span class="va">Fragment</span><span class="op">)</span></span></code></pre></div>
<p>This way we have uptake calculated in Daltons. If there is FD
(labeled with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mi>x</mi><mi>p</mi><mi>o</mi><mi>s</mi><mi>u</mi><mi>r</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">Exposure</annotation></semantics></math>
value), here is how to normalize uptake with respect to selected
measurement:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># select FD based on Exposure in time_100</span></span>
<span><span class="va">fd_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">kin_dat</span>, <span class="va">Exposure</span> <span class="op">==</span> <span class="va">time_100</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">arrange</span><span class="op">(</span><span class="va">Start</span>, <span class="va">End</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span>ID <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># normalize the uptake data and calculate uncertainty</span></span>
<span>  <span class="va">kin_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">kin_dat</span>, <span class="va">fd_dat</span>,</span>
<span>               by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Protein"</span>, <span class="st">"Start"</span>, <span class="st">"End"</span>, <span class="st">"Sequence"</span>, <span class="st">"Modification"</span>, <span class="st">"MaxUptake"</span>, <span class="st">"MHP"</span>, <span class="st">"State"</span><span class="op">)</span>,</span>
<span>               suffixes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">"_fd"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span>frac_deut_uptake <span class="op">=</span> <span class="va">deut_uptake</span><span class="op">/</span><span class="va">deut_uptake_fd</span>,</span>
<span>           err_frac_deut_uptake <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="va">err_deut_uptake</span><span class="op">/</span><span class="va">deut_uptake_fd</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="op">(</span><span class="va">deut_uptake</span><span class="op">*</span><span class="va">err_deut_uptake_fd</span><span class="op">/</span><span class="va">deut_uptake_fd</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">Exposure_fd</span>, <span class="op">-</span><span class="va">deut_uptake_fd</span>, <span class="op">-</span><span class="va">err_deut_uptake_fd</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Exposure</span> <span class="op">&gt;</span> <span class="va">time_0</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">arrange</span><span class="op">(</span><span class="va">Start</span>, <span class="va">End</span>, <span class="va">State</span>, <span class="va">Exposure</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">select</span><span class="op">(</span><span class="va">ID</span>, <span class="fu">everything</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">kin_dat</span>, <span class="st">"time_100"</span><span class="op">)</span><span class="op">=</span> <span class="va">time_100</span></span>
<span>  </span></code></pre></div>
<p>If FD is labeled differently, adjust the code.</p>
<p>Calculated kin_dat can be used in e.q.
<code><a href="../reference/plot_chiclet.html">HaDeX::plot_chiclet()</a></code> function. For more information check
<code>vignette("code_usage")</code> article.</p>
</div>
<div class="section level2">
<h2 id="hdexaminer">HDeXaminer<a class="anchor" aria-label="anchor" href="#hdexaminer"></a>
</h2>
<p>We do not have much experience with HDeXaminer, but we encountered
data source labeled as HDeXaminer source in PRIDE. We want to discuss
them briefly.</p>
<p>If the file has following columns:</p>
<pre><code><span><span class="co">#&gt;  [1] "Protein State" "Deut Time"     "Experiment"    "Start"        </span></span>
<span><span class="co">#&gt;  [5] "End"           "Sequence"      "Charge"        "Search RT"    </span></span>
<span><span class="co">#&gt;  [9] "Actual RT"     "# Spectra"     "Peak Width"    "m/z Shift"    </span></span>
<span><span class="co">#&gt; [13] "Max Inty"      "Exp Cent"      "Theor Cent"    "Score"        </span></span>
<span><span class="co">#&gt; [17] "Cent Diff"     "# Deut"        "Deut %"        "Confidence"</span></span></code></pre>
<p>it can be processed with <code><a href="../reference/read_hdx.html">HaDeX::read_hdx()</a></code> from the code
level, as it requires additional action from the user. Then, this data
can be used as described in other articles.</p>
<p>If the file has following columns:</p>
<pre><code><span><span class="co">#&gt;  [1] "Protein State"      "Protein"            "Start"             </span></span>
<span><span class="co">#&gt;  [4] " End"               "Sequence"           "Peptide Mass"      </span></span>
<span><span class="co">#&gt;  [7] "RT (min)"           "Deut Time (sec)"    "maxD"              </span></span>
<span><span class="co">#&gt; [10] "Theor #D"           "#D"                 "%D"                </span></span>
<span><span class="co">#&gt; [13] "Conf Interval (#D)" "#Rep"               "Confidence"        </span></span>
<span><span class="co">#&gt; [16] "Stddev"             "p"</span></span></code></pre>
<p>we can transform in directly into uptake dat in just a few steps.
Keep in mind that from this file format some information is missing
(e.q. uncertainty):</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># select only necessary columns</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="fl">8</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co"># adjust column names</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"State"</span>, <span class="st">"Protein"</span>, <span class="st">"Start"</span>, <span class="st">"End"</span>, <span class="st">"Sequence"</span>, <span class="st">"MHP"</span>,  <span class="st">"Exposure"</span>, <span class="st">"MaxUptake"</span>, <span class="st">"theo_deut_uptake"</span>, <span class="st">"deut_uptake"</span>, <span class="st">"frac_deut_uptake"</span><span class="op">)</span></span>
<span><span class="co"># change units</span></span>
<span><span class="va">dat</span><span class="op">[</span><span class="st">"Exposure"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="st">"Exposure"</span><span class="op">]</span><span class="op">/</span><span class="fl">60</span></span>
<span><span class="va">dat</span><span class="op">[</span><span class="st">"frac_deut_uptake"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="st">"frac_deut_uptake"</span><span class="op">]</span><span class="op">/</span><span class="fl">100</span></span>
<span></span>
<span><span class="co"># add ID</span></span>
<span><span class="va">peptide_list</span> <span class="op">&lt;-</span> <span class="fu">select</span><span class="op">(</span><span class="va">dat</span>, <span class="va">Sequence</span>, <span class="va">Start</span>, <span class="va">End</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">Start</span>, <span class="va">End</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>ID <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">kin_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">peptide_list</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sequence"</span>, <span class="st">"Start"</span>, <span class="st">"End"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">Start</span>, <span class="va">End</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># mock uncertainty for plots</span></span>
<span><span class="va">kin_dat</span><span class="op">[</span><span class="st">"err_frac_deut_uptake"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">kin_dat</span><span class="op">[</span><span class="st">"err_deut_uptake"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></code></pre></div>
<p>then, when we have the uptake data, if can be used directly in HaDeX
workflow:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># select one state for classification </span></span>
<span><span class="va">kin_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">kin_dat</span>, <span class="va">State</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">kin_dat</span><span class="op">[[</span><span class="st">"State"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">)</span></span>
<span></span>
<span><span class="co"># show uptake dat in form of chiclet plot</span></span>
<span><span class="fu"><a href="../reference/plot_chiclet.html">plot_chiclet</a></span><span class="op">(</span><span class="va">kin_dat</span>, fractional <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Weronika Puchala, Michal Burdukiewicz.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
