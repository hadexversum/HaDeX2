<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Calculations • HaDeX2</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculations">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">HaDeX2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/data_input.html">Importing data</a></li>
    <li><a class="dropdown-item" href="../articles/datafiles.html">Calculations</a></li>
    <li><a class="dropdown-item" href="../articles/example.html">Example HDX-MS data analysis</a></li>
    <li><a class="dropdown-item" href="../articles/glossary.html">Glossary</a></li>
    <li><a class="dropdown-item" href="../articles/mass_comparison.html">Mass calculation</a></li>
    <li><a class="dropdown-item" href="../articles/quality_control.html">Quality control</a></li>
    <li><a class="dropdown-item" href="../articles/statistics.html">Statistics</a></li>
    <li><a class="dropdown-item" href="../articles/transformation.html">Data aggregation</a></li>
    <li><a class="dropdown-item" href="../articles/usage.html">Code usage</a></li>
    <li><a class="dropdown-item" href="../articles/version_comparison.html">Comparison between versions</a></li>
    <li><a class="dropdown-item" href="../articles/visualization.html">Data visualization</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Calculations</h1>
            
      

      <div class="d-none name"><code>datafiles.Rmd</code></div>
    </div>

    
    
<p>In this article we discuss the transformation of the data, with
description of every calculated step. For the visualization methods of
described values, see <code><a href="../articles/visualization.html">vignette("visualization")</a></code>.</p>
<div class="section level2">
<h2 id="initial-processing-of-the-data">Initial processing of the data<a class="anchor" aria-label="anchor" href="#initial-processing-of-the-data"></a>
</h2>
<p>Let’s start with a glimpse of the datafile - in this case, in
<code>cluster</code> format from DynamX. For more information about
accepted datafiles see <code><a href="../articles/data_input.html">vignette("data_input")</a></code></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://hadexversum.github.io/HaDeX2/">HaDeX2</a></span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_hdx.html">read_hdx</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"HaDeX2"</span>, <span class="st">"HaDeX/data/KD_180110_CD160_HVEM.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fl">6</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     Protein Start   End        Sequence Modification MaxUptake      MHP  State</span></span>
<span><span class="co">##      &lt;char&gt; &lt;int&gt; &lt;int&gt;          &lt;char&gt;       &lt;lgcl&gt;     &lt;num&gt;    &lt;num&gt; &lt;char&gt;</span></span>
<span><span class="co">## 1: db_CD160     1    15 INITSSASQEGTRLN           NA        14 1590.808  CD160</span></span>
<span><span class="co">## 2: db_CD160     1    15 INITSSASQEGTRLN           NA        14 1590.808  CD160</span></span>
<span><span class="co">## 3: db_CD160     1    15 INITSSASQEGTRLN           NA        14 1590.808  CD160</span></span>
<span><span class="co">## 4: db_CD160     1    15 INITSSASQEGTRLN           NA        14 1590.808  CD160</span></span>
<span><span class="co">## 5: db_CD160     1    15 INITSSASQEGTRLN           NA        14 1590.808  CD160</span></span>
<span><span class="co">## 6: db_CD160     1    15 INITSSASQEGTRLN           NA        14 1590.808  CD160</span></span>
<span><span class="co">##    Exposure                    File     z  Inten    Center</span></span>
<span><span class="co">##       &lt;num&gt;                  &lt;char&gt; &lt;int&gt;  &lt;num&gt;     &lt;num&gt;</span></span>
<span><span class="co">## 1:    0.000 KD_160527_CD160_sekw_05     1   6592 1591.2584</span></span>
<span><span class="co">## 2:    0.000 KD_160527_CD160_sekw_05     2 394066  796.3552</span></span>
<span><span class="co">## 3:    0.000 KD_160527_CD160_sekw_05     3 173526  531.2633</span></span>
<span><span class="co">## 4:    0.001   KD_160527_CD160_IN_01     2 232221  796.3634</span></span>
<span><span class="co">## 5:    0.001   KD_160527_CD160_IN_01     3 110675  531.2849</span></span>
<span><span class="co">## 6:    0.167  KD_160530_CD160_10s_01     2  99894  800.3610</span></span></code></pre>
<p>As we see, the data file has a very specific structure and is not
informative yet. In the file, we have
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>/</mi><mi>z</mi></mrow><annotation encoding="application/x-tex">m/z</annotation></semantics></math>
values for each
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>
value (charge) for each time point
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mi>x</mi><mi>p</mi><mi>o</mi><mi>s</mi><mi>u</mi><mi>r</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">Exposure</annotation></semantics></math>)
for each state of each peptide, repeated as many times as measurement
was repeated (each measurement should be repeated at least three
times).</p>
<p>Our aim is to have one result with an uncertainty of the measurement
per each peptide in each biological state in each measured time point -
data in this format allows further calculations, e.q. calculating
deuterium uptake values.</p>
<p>For a better understanding of the process of aggregating the data,
see the <code><a href="../articles/transformation.html">vignette("transformation")</a></code> article.</p>
<p>Within each replicate of the measurement (we recognize each replicate
by the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mi>i</mi><mi>l</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">File</annotation></semantics></math>
value), the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>/</mi><mi>z</mi></mrow><annotation encoding="application/x-tex">m/z</annotation></semantics></math>
values are provided for each possible
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>
value. The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>/</mi><mi>z</mi></mrow><annotation encoding="application/x-tex">m/z</annotation></semantics></math>
values are in the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>r</mi></mrow><annotation encoding="application/x-tex">Center</annotation></semantics></math>
column, as it is a geometrical centroid calculated from the isotopic
envelope. Firstly, we have to calculate the mass value, measured
experimentally:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mi>x</mi><mi>p</mi><mi>M</mi><mi>a</mi><mi>s</mi><mi>s</mi><mo>=</mo><mi>z</mi><mo>×</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>C</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>r</mi><mo>−</mo><mi>p</mi><mi>r</mi><mi>o</mi><mi>t</mi><mi>o</mi><mi>n</mi><mi>M</mi><mi>a</mi><mi>s</mi><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">expMass = z \times (Center-protonMass)\tag{1}</annotation></semantics></math>
To aggregate data from different
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>
values, we have to calculate the mean mass weighted by intensity.
Additional information about this step and how the weighted mean impacts
the results can be found in <code><a href="../articles/mass_comparison.html">vignette("mass_comparison")</a></code>
article.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>g</mi><mi>g</mi><mi>M</mi><mi>a</mi><mi>s</mi><mi>s</mi><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mi>I</mi><mi>n</mi><mi>t</mi><mi>e</mi><msub><mi>n</mi><mi>k</mi></msub><mo>⋅</mo><mi>p</mi><mi>e</mi><mi>p</mi><mi>M</mi><mi>a</mi><mi>s</mi><msub><mi>s</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">aggMass = \frac{1}{N}\sum_{k = 1}^{N}Inten_k{\cdot}pepMass_k\tag{2}</annotation></semantics></math>.</p>
<p>Where:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>g</mi><mi>g</mi><mi>M</mi><mi>a</mi><mi>s</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">aggMass</annotation></semantics></math>
- mass of the peptide [Da], average from replicates,</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mi>n</mi><mi>t</mi><mi>e</mi><msub><mi>n</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">Inten_k</annotation></semantics></math>
- intensity of the measurement,</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>e</mi><mi>p</mi><mi>M</mi><mi>a</mi><mi>s</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">pepMass</annotation></semantics></math>
- mass of the peptide, calculated using Equation 1.</li>
</ul>
<p>As we use the aggregated result from the replicates, we need to
calculate an uncertainty associated with the measurement. We use the
mean value as the final result, so we need to calculate error as a
standard deviation of the mean, according to the Equation 3:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>x</mi><mo accent="true">→</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msqrt><mfrac><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover><mi>x</mi><mo accent="true">¯</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mrow><mrow><mi>n</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></msqrt></mrow><annotation encoding="application/x-tex">u(\vec{x}) = \sqrt{\frac{ \sum_{i=1}^n \left( x_{i} - \overline{x} \right)^2}{n(n-1)}}\tag{3}</annotation></semantics></math>.</p>
<p>Where:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>i</mi></msub><annotation encoding="application/x-tex">x_{i}</annotation></semantics></math>
- measured value from a replicate,</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>x</mi><mo accent="true">¯</mo></mover><annotation encoding="application/x-tex">\overline{x}</annotation></semantics></math>
- mean value from all of the replicates,</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
- number of replicates.</li>
</ul>
<p>Now we have the format we want for further calculations.</p>
</div>
<div class="section level2">
<h2 id="calculation-of-the-deuterium-uptake">Calculation of the deuterium uptake<a class="anchor" aria-label="anchor" href="#calculation-of-the-deuterium-uptake"></a>
</h2>
<p>HaDeX package provides the calculated values in different forms. All
of them are provided with associated uncertainty of the measurement. All
of the uncertainties are derived from the formula - the Law of
propagation of uncertainty:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mi>c</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>y</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msqrt><mrow><munder><mo>∑</mo><mi>k</mi></munder><msup><mrow><mo stretchy="true" form="prefix">[</mo><mfrac><mrow><mi>∂</mi><mi>y</mi></mrow><mrow><mi>∂</mi><msub><mi>x</mi><mi>k</mi></msub></mrow></mfrac><mi>u</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mn>2</mn></msup></mrow></msqrt></mrow><annotation encoding="application/x-tex">u_{c}(y) = \sqrt{\sum_{k} \left[ \frac{\partial y}{\partial x_{k}} u(x_{k}) \right]^2}</annotation></semantics></math></p>
<div class="section level3">
<h3 id="deuterium-uptake">Deuterium uptake<a class="anchor" aria-label="anchor" href="#deuterium-uptake"></a>
</h3>
<p>Deuterium uptake is the increase of the mass of the peptide in time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>.
The minimal exchange control
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>m</mi><msub><mi>t</mi><mn>0</mn></msub></msub><annotation encoding="application/x-tex">m_{t_0}</annotation></semantics></math>
is mass measured directly after adding the buffer (before the start of
the exchange), and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>m</mi><mi>t</mi></msub><annotation encoding="application/x-tex">m_t</annotation></semantics></math>
is the mass measured in chosen time point
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>.
The value is in Daltons [Da].</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo>=</mo><msub><mi>m</mi><mi>t</mi></msub><mo>−</mo><msub><mi>m</mi><msub><mi>t</mi><mn>0</mn></msub></msub></mrow><annotation encoding="application/x-tex">D = m_{t} - m_{t_0}</annotation></semantics></math>
The uncertainty associated with deuterium uptake [Da] (based on equation
3):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mi>c</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>D</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msqrt><mrow><mi>u</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>m</mi><mi>t</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>+</mo><mi>u</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>m</mi><msub><mi>t</mi><mn>0</mn></msub></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mrow></msqrt></mrow><annotation encoding="application/x-tex">u_c(D) = \sqrt{u(m_t)^2 + u(m_{t_0})^2}</annotation></semantics></math></p>
</div>
<div class="section level3">
<h3 id="fractional-deuterium-uptake">Fractional deuterium uptake<a class="anchor" aria-label="anchor" href="#fractional-deuterium-uptake"></a>
</h3>
<p>Fractional deuterium uptake is the ratio of the increase of the mass
in time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
to the maximal exchange control. The maximal exchange control
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>m</mi><msub><mi>t</mi><mn>100</mn></msub></msub><annotation encoding="application/x-tex">m_{t_{100}}</annotation></semantics></math>
is measured after a long time (chosen by the experimenter, usually 1440
min = 24 h). It is assumed that after this long time, the exchange is
finished. The minimal exchange control
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>m</mi><msub><mi>t</mi><mn>0</mn></msub></msub><annotation encoding="application/x-tex">m_{t_0}</annotation></semantics></math>
is mass measured directly after adding the buffer (before the start of
the exchange), and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>m</mi><mi>t</mi></msub><annotation encoding="application/x-tex">m_t</annotation></semantics></math>
is the mass measured in chosen time point
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>.
This value is a percentage value [%].</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mrow><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi></mrow></msub><mo>=</mo><mfrac><mrow><msub><mi>m</mi><mi>t</mi></msub><mo>−</mo><msub><mi>m</mi><msub><mi>t</mi><mn>0</mn></msub></msub></mrow><mrow><msub><mi>m</mi><msub><mi>t</mi><mn>100</mn></msub></msub><mo>−</mo><msub><mi>m</mi><msub><mi>t</mi><mn>0</mn></msub></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">D_{frac} = \frac{m_{t} - m_{t_0}}{m_{t_{100}} - m_{t_0}}</annotation></semantics></math></p>
<p>The uncertainty associated with fractional deuterium uptake [%]
(based on equation 3):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mi>c</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>D</mi><mrow><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msqrt><mrow><msup><mrow><mo stretchy="true" form="prefix">[</mo><mfrac><mn>1</mn><mrow><msub><mi>m</mi><msub><mi>t</mi><mn>100</mn></msub></msub><mo>−</mo><msub><mi>m</mi><msub><mi>t</mi><mn>0</mn></msub></msub></mrow></mfrac><mi>u</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>m</mi><mi>t</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">[</mo><mfrac><mrow><msub><mi>m</mi><mi>t</mi></msub><mo>−</mo><msub><mi>m</mi><msub><mi>t</mi><mn>100</mn></msub></msub></mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>m</mi><msub><mi>t</mi><mn>100</mn></msub></msub><mo>−</mo><msub><mi>m</mi><msub><mi>t</mi><mn>0</mn></msub></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mfrac><mi>u</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>m</mi><msub><mi>t</mi><mn>0</mn></msub></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">[</mo><mfrac><mrow><msub><mi>m</mi><msub><mi>t</mi><mn>0</mn></msub></msub><mo>−</mo><msub><mi>m</mi><mi>t</mi></msub></mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>m</mi><msub><mi>t</mi><mn>100</mn></msub></msub><mo>−</mo><msub><mi>m</mi><msub><mi>t</mi><mn>0</mn></msub></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mfrac><mi>u</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>m</mi><msub><mi>t</mi><mn>100</mn></msub></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mn>2</mn></msup></mrow></msqrt></mrow><annotation encoding="application/x-tex">u_{c}(D_{frac}) = \sqrt{ \left[ 
\frac{1}{m_{t_{100}}-m_{t_0}} u(m_{t}) \right]^2 + 
\left[ \frac{m_{t} - m_{t_{100}}}{(m_{t_{100}}-m_{t_0})^2} u(m_{t_0}) \right]^2 + 
\left[ \frac{m_{t_0} - m_{t}}{(m_{t_{100}}-m_{t_0})^2} u (m_{t_{100}}) \right]^2}</annotation></semantics></math></p>
</div>
<div class="section level3">
<h3 id="theoretical-deuterium-uptake">Theoretical deuterium uptake<a class="anchor" aria-label="anchor" href="#theoretical-deuterium-uptake"></a>
</h3>
<p>Theoretical deuterium uptake is the increase of mass in time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
compared with the theoretical value of the peptide mass without any
exchange
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>H</mi><mi>P</mi></mrow><annotation encoding="application/x-tex">MHP</annotation></semantics></math>
- a mass of the singly charged monoisotopic molecular ion), and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>m</mi><mi>t</mi></msub><annotation encoding="application/x-tex">m_t</annotation></semantics></math>
is the mass measured in chosen time point
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>.
This value is in daltons [Da]:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mrow><mi>t</mi><mi>h</mi><mi>e</mi><mi>o</mi></mrow></msub><mo>=</mo><msub><mi>m</mi><mi>t</mi></msub><mo>−</mo><mi>M</mi><mi>H</mi><mi>P</mi></mrow><annotation encoding="application/x-tex">D_{theo} = m_{t} - MHP</annotation></semantics></math></p>
<p>The uncertainty associated with theoretical deuterium uptake [Da]
(the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>H</mi><mi>P</mi></mrow><annotation encoding="application/x-tex">MHP</annotation></semantics></math>
value is a constant without measurement uncertainty - based on the
equation 3):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>D</mi><mrow><mi>t</mi><mi>h</mi><mi>e</mi><mi>o</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>u</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>m</mi><mi>t</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">u(D_{theo}) = u(m_t)</annotation></semantics></math></p>
</div>
<div class="section level3">
<h3 id="theoretical-fractional-deuterium-uptake">Theoretical fractional deuterium uptake<a class="anchor" aria-label="anchor" href="#theoretical-fractional-deuterium-uptake"></a>
</h3>
<p>Theoretical fractional deuterium uptake is the ratio of the increase
of mass in time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
compared with a theoretical value of the mass of the peptide without any
exchange to the possible theoretical increase of the mass, based on the
maximal potential uptake of the peptide (based on the peptide sequence).
This value is a percentage value [%].</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mrow><mi>t</mi><mi>h</mi><mi>e</mi><mi>o</mi><mo>,</mo><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi></mrow></msub><mo>=</mo><mfrac><mrow><msub><mi>m</mi><mi>t</mi></msub><mo>−</mo><mi>M</mi><mi>H</mi><mi>P</mi></mrow><mrow><mi>M</mi><mi>a</mi><mi>x</mi><mi>U</mi><mi>p</mi><mi>t</mi><mi>a</mi><mi>k</mi><mi>e</mi><mo>×</mo><mi>p</mi><mi>r</mi><mi>o</mi><mi>t</mi><mi>o</mi><mi>n</mi><mi>M</mi><mi>a</mi><mi>s</mi><mi>s</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">D_{theo, frac} = \frac{m_{t}-MHP}{MaxUptake \times protonMass}</annotation></semantics></math></p>
<p>The uncertainty associated with theoretical fractional deuterium
uptake [%] (based on the equation 3):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>D</mi><mrow><mi>t</mi><mi>h</mi><mi>e</mi><mi>o</mi><mo>,</mo><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">|</mo><mfrac><mn>1</mn><mrow><mi>M</mi><mi>a</mi><mi>x</mi><mi>U</mi><mi>p</mi><mi>t</mi><mi>a</mi><mi>k</mi><mi>e</mi><mo>×</mo><mi>p</mi><mi>r</mi><mi>o</mi><mi>t</mi><mi>o</mi><mi>n</mi><mi>M</mi><mi>a</mi><mi>s</mi><mi>s</mi></mrow></mfrac><mi>u</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>D</mi><mi>t</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">|</mo></mrow></mrow><annotation encoding="application/x-tex">u(D_{theo, frac}) = \left|\frac{1}{MaxUptake \times protonMass} u(D_{t}) \right|</annotation></semantics></math></p>
</div>
</div>
<div class="section level2">
<h2 id="differential-values">Differential values<a class="anchor" aria-label="anchor" href="#differential-values"></a>
</h2>
<p>Differential value is the way to see how the deuterium uptake differs
between two biological states. It allows seeing if the possible
difference is statistically important (more information below). This
value is calculated as the difference between the previously described
(in a chosen form) deuterium uptake of the first and second states.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>i</mi><mi>f</mi><mi>f</mi><mo>=</mo><msub><mi>D</mi><mn>1</mn></msub><mo>−</mo><msub><mi>D</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">diff = D_{1} - D_{2}</annotation></semantics></math>
The uncertainty associated with the difference of deuterium uptake
(based on the equation 3):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mi>c</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>d</mi><mi>i</mi><mi>f</mi><mi>f</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msqrt><mrow><mi>u</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>D</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>+</mo><mi>u</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>D</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mrow></msqrt></mrow><annotation encoding="application/x-tex">u_{c}(diff) = \sqrt{u(D_{1})^2 + u(D_{2})^2}</annotation></semantics></math></p>
<p>The convenient way to present results calculated as described is the
comparison plot and differential plot (Woods’ plot).</p>
</div>
<div class="section level2">
<h2 id="deuterium-uptake-aggregation">Deuterium uptake aggregation<a class="anchor" aria-label="anchor" href="#deuterium-uptake-aggregation"></a>
</h2>
<p>Aggregation of values is inspired by an already published solution
<span class="citation">(Keppel and Weis 2015)</span>. This process can
be conducted of any deuterium uptake variation - fractional or absolute,
with theoretical or experimental control, single-state or
differential.</p>
<p>For each residue
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
there is a subset of peptides
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>)
covering said residue. Then, the final
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>D</mi><mrow><mi>i</mi><mo>,</mo><mi>a</mi><mi>g</mi><mi>g</mi></mrow></msub><annotation encoding="application/x-tex">D_{i, agg}</annotation></semantics></math>
is calculated from the subset of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>D</mi><mi>k</mi></msub><annotation encoding="application/x-tex">D_k</annotation></semantics></math>
(where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>&lt;</mo><mi>k</mi><mo>&lt;</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">0&lt;k&lt;n</annotation></semantics></math>),
with weights
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mi>k</mi></msub><annotation encoding="application/x-tex">w_k</annotation></semantics></math>
inverse proportional to the max uptake of peptide
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>a</mi><mi>x</mi><mi>U</mi><mi>p</mi><mi>t</mi><mi>a</mi><mi>k</mi><msub><mi>e</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">MaxUptake_k</annotation></semantics></math>)
- the shortest the peptide the highest the possibility that the uptake
took place in said residue:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>k</mi></msub><mo>=</mo><mfrac><mfrac><mn>1</mn><mrow><mi>M</mi><mi>a</mi><mi>x</mi><mi>U</mi><mi>p</mi><mi>t</mi><mi>a</mi><mi>k</mi><msub><mi>e</mi><mi>k</mi></msub></mrow></mfrac><mrow><munder><mo>∑</mo><mi>n</mi></munder><mfrac><mn>1</mn><mrow><mi>M</mi><mi>a</mi><mi>x</mi><mi>U</mi><mi>p</mi><mi>t</mi><mi>a</mi><mi>k</mi><msub><mi>e</mi><mi>k</mi></msub></mrow></mfrac></mrow></mfrac></mrow><annotation encoding="application/x-tex">
w_k = \frac{\frac{1}{MaxUptake_k}}{\sum_n \frac{1}{MaxUptake_k}}
</annotation></semantics></math> The weights are normalized:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><munder><mo>∑</mo><mi>n</mi></munder><msub><mi>w</mi><mi>k</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">
\sum_n w_k = 1
</annotation></semantics></math> Then, the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>D</mi><mrow><mi>i</mi><mo>,</mo><mi>a</mi><mi>g</mi><mi>g</mi></mrow></msub><annotation encoding="application/x-tex">D_{i, agg}</annotation></semantics></math>
is a weighted average of set of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>D</mi><mi>n</mi></msub><annotation encoding="application/x-tex">D_n</annotation></semantics></math>.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mrow><mi>i</mi><mo>,</mo><mi>a</mi><mi>g</mi><mi>g</mi></mrow></msub><mo>=</mo><mfrac><mrow><munder><mo>∑</mo><mi>n</mi></munder><msub><mi>w</mi><mi>k</mi></msub><mo>⋅</mo><msub><mi>D</mi><mi>k</mi></msub></mrow><mrow><munder><mo>∑</mo><mi>n</mi></munder><msub><mi>w</mi><mi>k</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">
D_{i, agg} = \frac{\sum_n w_k \cdot D_k}{\sum_n w_k}
</annotation></semantics></math> This process is done for each residue
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
to cover whole protein data.</p>
<p>As for previous values, also for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>D</mi><mrow><mi>i</mi><mo>,</mo><mi>a</mi><mi>g</mi><mi>g</mi></mrow></msub><annotation encoding="application/x-tex">D_{i, agg}</annotation></semantics></math>
the uncertainty is calculated:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>D</mi><mrow><mi>i</mi><mo>,</mo><mi>a</mi><mi>g</mi><mi>g</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msqrt><mrow><munder><mo>∑</mo><mi>n</mi></munder><msup><mrow><mo stretchy="true" form="prefix">[</mo><mfrac><mrow><msub><mi>w</mi><mi>k</mi></msub><mo>⋅</mo><mi>U</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>D</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><munder><mo>∑</mo><mi>n</mi></munder><msub><mi>w</mi><mi>k</mi></msub></mrow></mfrac><mo stretchy="true" form="postfix">]</mo></mrow><mn>2</mn></msup></mrow></msqrt></mrow><annotation encoding="application/x-tex">
u(D_{i, agg}) = \sqrt{ \sum_{n} \left[ \frac{  w_k \cdot U(D_k)}{ \sum_n w_k } \right] ^2}
</annotation></semantics></math></p>
</div>
<div class="section level2">
<h2 id="back-exchange">Back-exchange<a class="anchor" aria-label="anchor" href="#back-exchange"></a>
</h2>
<p>Back-exchange is a reverse exchange - from already exchange deuterium
back to hydrogen.</p>
<p>Back-exchange
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mi>e</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">bex</annotation></semantics></math>)
is calculated for each peptide and is defined as the difference between
fractional theoretical deuterium uptake of the experimental maximal
deuterium control and 100% of exchange.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mi>e</mi><mi>x</mi><mo>=</mo><mn>100</mn><mo>−</mo><msub><mi>D</mi><mrow><mi>t</mi><mi>h</mi><mi>e</mi><mi>o</mi><mo>,</mo><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mn>100</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
bex = 100 - D_{theo, frac}(t_{100})
</annotation></semantics></math></p>
</div>
<div class="section level2">
<h2 id="auc">AUC<a class="anchor" aria-label="anchor" href="#auc"></a>
</h2>
<p>Area under the curve describes the whole plot. It is calculated with
respect to the last time point, used as normalizing value to obtain the
result from range [0, 1]. The normalization is done also for the time
axis.</p>
<p>If the AUC value exceeds the value 1, it is an indicator of
back-exchange.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>u</mi><mi>c</mi><mo>=</mo><munderover><mo>∑</mo><mi>i</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></munderover><mrow><mo stretchy="true" form="prefix">(</mo><mi>d</mi><msub><mi>u</mi><mrow><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mo>,</mo><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>d</mi><msub><mi>u</mi><mrow><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mo>,</mo><mi>i</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mrow><mi>n</mi><mi>o</mi><mi>r</mi><mi>m</mi><mo>,</mo><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi>t</mi><mrow><mi>n</mi><mi>o</mi><mi>r</mi><mi>m</mi><mo>,</mo><mi>i</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>⋅</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">
auc = \sum_i^{n-1} (du_{frac, i+1} + du_{frac, i}) \cdot (t_{norm, i+1} - t_{norm, i}) \cdot \frac{1}{2}
</annotation></semantics></math></p>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-keppel_mapping_2015" class="csl-entry">
Keppel, Theodore R., and David D. Weis. 2015. <span>“Mapping
<span>Residual</span> <span>Structure</span> in
<span>Intrinsically</span> <span>Disordered</span> <span>Proteins</span>
at <span>Residue</span> <span>Resolution</span> <span>Using</span>
<span>Millisecond</span> <span>Hydrogen</span>/<span>Deuterium</span>
<span>Exchange</span> and <span>Residue</span>
<span>Averaging</span>.”</span> <em>Journal of the American Society for
Mass Spectrometry</em> 26 (4): 547–54. <a href="https://doi.org/10.1007/s13361-014-1033-6" class="external-link">https://doi.org/10.1007/s13361-014-1033-6</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Weronika Puchala, Michal Burdukiewicz.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
