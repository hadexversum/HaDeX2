<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Example HDX-MS data analysis • HaDeX</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Example HDX-MS data analysis">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">HaDeX</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/data_input.html">Importing data</a></li>
    <li><a class="dropdown-item" href="../articles/datafiles.html">Calculations</a></li>
    <li><a class="dropdown-item" href="../articles/example.html">Example HDX-MS data analysis</a></li>
    <li><a class="dropdown-item" href="../articles/glossary.html">Glossary</a></li>
    <li><a class="dropdown-item" href="../articles/mass_comparison.html">Mass calculation</a></li>
    <li><a class="dropdown-item" href="../articles/quality_control.html">Quality control</a></li>
    <li><a class="dropdown-item" href="../articles/transformation.html">Data aggregation</a></li>
    <li><a class="dropdown-item" href="../articles/usage.html">Code usage</a></li>
    <li><a class="dropdown-item" href="../articles/visualization.html">Data visualization</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Example HDX-MS data analysis</h1>
            
      

      <div class="d-none name"><code>example.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This document summarizes functions of HaDeX2 web server by describing
example data analysis. The example dataset we will use here is part of a
previously published dataset on the SecA ATPase protein . SecA is an
essential part of the bacterial Sec protein secretion system where it
interacts with secretory client proteins as well as its associated
cytoplasmic chaperones and is ultimately targeted to the SecYEG membrane
channel where it interacts with both non-folded clients as well as the
export channel, thereby regulating or powering protein export.</p>
<p>SecA is a DEAD motor domain ATPase, and in the cytoplasm the protein
predominantly exists as a dimeric, ADP bound ‘quiescent’ state. Only
through a series of interactions with the translocate and secretory
clients does SecA become fully activated and reaches the actively ATP
hydrolysing monomeric state, functioning as a molecular motor, driving
protein translocation.</p>
</div>
<div class="section level2">
<h2 id="data-analysis-with-hadex2">Data analysis with HaDeX2<a class="anchor" aria-label="anchor" href="#data-analysis-with-hadex2"></a>
</h2>
<p>In the next sections we will take the SecA example data and stepwise
run it though the analysis pipeline of the HaDeX2 web server. In this
example we focus on SecA in its dimeric state, and we compare how
binding to ADP, switching the protein to its quiescent state, affects
the structural dynamics of SecA.</p>
</div>
<div class="section level2">
<h2 id="input-data">Input Data<a class="anchor" aria-label="anchor" href="#input-data"></a>
</h2>
<p>The first step in our HDX-MS data analysis is to upload the data. In
the HaDeX2 webserver, in the ‘Input data’ tab, we can upload the data as
DynamX 3.0 ‘cluster’ files. Click ‘Browse’ to select the example data
file <code>data/SecA_cluster_wt_ADP.csv</code>, after which the ‘File
status’ should report the file is valid and is of the Dynamx3.0 format.
For this dataset, we also have a structure file available,
<code>data/SecA_monomer.pdb</code> (modified from RCSB PDB entry 2VDA),
and it can be uploaded below in a similar fashion. [JHS suggestion:
perhaps at this stage we don’t want to get into this but placing the
upload form for the structure next to the data upload would make more
sense from a data input flow perspective]</p>
<p>Next, we set the parameters for the analysis of this data. We select
the correct protein (‘Accession’), then choose which peptides correspond
to the Maximal exchange control (Accession | Full Deuteration control |
0.167). The No deuterated time point is set to 0.</p>
<!-- ## Inspecting HDX peptides -->
<div class="section level3">
<h3 id="deuterium-uptake">Deuterium uptake<a class="anchor" aria-label="anchor" href="#deuterium-uptake"></a>
</h3>
<p>We can start by looking at deuterium uptake per peptide/timepoint.
The first plot generated is the Deuterium uptake plot (Figure
@ref{fig:fig_d_uptake}). This shows replicate-averaged deuterium uptake
values per peptide, for all selected states, at a given timepoint. It
provides a good starting point to inspect the data, and verify no
peptide deuterium uptake exceeds the maximal uptake control uptake.</p>
<div class="float">
<img src="comparison-display_plot.png" alt="Deuterium uptake plot"><div class="figcaption">Deuterium uptake plot</div>
</div>
<p>The second plot on this page is the Woods plot. This plot shows the
deuterium uptake difference between two selected states, in our case
this is a comparison between SecA dimer WT and SecA dimer + ADP. [JHS
comment: the significance threshold is rather low here, this is because
this dataset has very low variability. I’m leaving out statistical
discussion for now. Side note: I can select both houde and student-t
(side-side note: should be Student’s T-test rather than t-Student test),
this should be an OR toggle?]. From the generated figure (@), we can
immediately see that two regions stand out, both part of the SecA
nucleotide-binding cleft, the first around 102-114 (Helicse motif I,
NBD1) and the second at 410-428 (NBD linker region). Deuterium uptake
differences in these regions are positive (red), indicating that these
regions rigidify upon ADP binding, and this rigidification
allosterically propagates to SecA’s client-binding clamp, thereby
regulating its client interactions and activity.</p>
<p>If we want to inspect these regions in more detail, we can use the
‘Ranges’ section in the sidebar to zoom the x range to the regions of
interest.</p>
<p>Next, to explore the data further, we can switch the plot to
‘Fractional uptake’, where we use the maximal exchange control as
reference. Select the checkbox ‘Calculation &gt; Fractional values’ and
then at ‘Timepoints’ make sure to select ‘chosen control’ for ‘Deut 100%
Exposure’ [JHS: this should be the default?]. With these settings the
Woods plot shows the differental HDX data in terms of fractional
deuterium uptake differences, removing the bias of peptide length.
Again, we see the same two regions stand out, and if we explore more
timepoints (‘Timepoints &gt; Measurement Exposure &gt; 2’), we find
additional peptides which show rigidification, such as 570-587 (motif
VI, NBD2) and 630-645 (scaffold domain).</p>
<div class="float">
<img src="woods-display_plot.png" alt="Woods plot"><div class="figcaption">Woods plot</div>
</div>
<p>The ‘Butterfly Differential plot’ provides a more comprehensive view
of all timepoints simultaneously. Switching to this view, we can more
easily track the evolution of deuterium uptake differences over time and
therefore all four regions of interest are clearly visible (Figure
@ref{fig:fig_butterfly}). This view reviews another potenially
rigidified region, showing only at later toimepoints, around the region
772-782.</p>
<div class="float">
<img src="butterfly-display_plot.png" alt="Butterfly Differential plot"><div class="figcaption">Butterfly Differential plot</div>
</div>
<p>[JHS comment: butterfly plot exports as ‘display_plot.png’, should be
‘butterfly_display_plot.png’ to avoid overwriting the previous
plot?]</p>
<p>The ‘Chiclet Plot’ provides a direct overview of the time-evolution
of differentially exchanged regions. Switching the plot to ‘Fractional
Values’, we can see that two regions (102-114, 410-428) are present
independent of the timepoint, while the differences in 570-587 increase
over time, and the 630-645 regions shows a ‘appear-disappear’ behavior,
being most prominent at intermediate timepoints (Figure
@ref{fig:fig_chiclet}).</p>
<div class="float">
<img src="chiclet-display_plot.png" alt="Chiclet Plot"><div class="figcaption">Chiclet Plot</div>
</div>
<p>To zoom in on this phenomenon, we can view the uptake curve of a
single peptide using the ‘Uptake Curves Plot / Differental Plot’. A
single peptide can be selected in the “Peptide” section of the sidebar.
Filter for sequence ‘AIANAQRKVE’, and choose this particular peptide
from the filtered table. Now, we can confirm that indeed for this
peptide, SecA WT initially takes up deuterium faster compared to SecA
bound to ADP, but at later timepoints the curves converge. The
‘Differential Plot’ directly shows the differences as a rise and
decay.</p>
</div>
<div class="section level3">
<h3 id="time-based-data">Time-based data<a class="anchor" aria-label="anchor" href="#time-based-data"></a>
</h3>
<p>The ‘Time-based data’ tab provides more information on replicates and
statistical significance between states. The ‘Replicates’ view gives a
quick overview of the replicates for each state and timepoint. For
example, the second plot on this page shows directly that for the
non-deuterated control (0s), there are a couple of peptides where one or
more replicates are missing. We can use this information to quickly
identify peptides which might need to be excluded or we need to collect
additional data. The Manhattan plot provides similar information the
Woods plot, but instead of reporting on deuterium uptake differences, it
shows the statistical significance of these differences. This can be an
important tool when judging how to interpret deuterium uptake
differences between peptides. In our example data, the Manhattan plot
shows that generally we have obtained a lot of peptide with
statistically significant differences, where regions with low or no
differences in D-uptake also show low statistical significance. Finally,
in the uncertainty plot we can see the calculated standard error of the
mean for the replicates to indicate regions of higher measurement
uncertainty for optional double-check, part of quality control.</p>
</div>
<div class="section level3">
<h3 id="hi-res-3d">Hi-res + 3D<a class="anchor" aria-label="anchor" href="#hi-res-3d"></a>
</h3>
<p>Because we have provided a structural model alongside our peptide
data, HaDeX2 allows us to directly visualize residue-level data mapped
onto the structure. To achieve this, we can use ‘Differential Heatmap +
3D Vis’. Again, we use ‘Fractional values’, and set ‘Deut 100% Exposure’
to ‘chosen control’. The generated heatmap (Figure
@ref{fig:fig_heatmap}) shows the same regions of interest, with as
critical difference that now instead of looking at peptide-level, the
data has been mapped to individual residues by weighted averaging.</p>
<div class="float">
<img src="differential_heatmap-display_plot.png" alt="Differential Heatmap"><div class="figcaption">Differential Heatmap</div>
</div>
<p>In the differential heatmap, we can now see our regions of interest
with residue-level resolution. The two main regions, 102-114 and
410-428, are clearly visible, as well as the more subtle differences in
570-587 and 630-645. The region around 772-782 is less clear in this
view, likely because this region is only subtly affected and only at
later timepoints.</p>
<p>The 3D viewer provides an interactive way to explore these
differences in the context of the protein structure. By mapping the
differential HDX data onto the 3D structure of SecA, we can directly see
how ADP binding rigidifies specific regions of the protein (red
@ref{fig:fig_differential_structure}). In the figure below, we can
clearly see the strongest response in helicase motif I, rigidifying upon
ADP binding, as well as the allosteric propagation of this effect
through the scaffold regions ultimately resulting in a long-range
allosteric response in the client-binding PPD domain.</p>
<p>For more control over the visualization colors and plot ranges, the
residue-level data can be exported in a .csv format and subsequently
visualized by <a href="http://hdxviewer.ipbs.fr:8080/" class="external-link">HDX-Viewer</a>
<span class="citation">(<strong>key?</strong>)</span>{BouyssieHDXViewerinteractive3D2019}.
When exporting the data to HDX-Viewer, click the ‘Export data for
HDXViewer’ and follow the steps described in the popup window. <img src="seca_3d_vis.png" alt="3D view of differential HDX data on the structure of SecA"></p>
</div>
<div class="section level3">
<h3 id="measurements">Measurements<a class="anchor" aria-label="anchor" href="#measurements"></a>
</h3>
<p>The ‘Measurements’ tab allows us to delve deeper into the individual
replicate measurement results. This tab provides a per-peptide view
where we can use the peptide table in the sidebar to select peptides of
interest. Then, for the selected exposure time, we can now inspect each
replicate measurement, see how they are distributed and we see which
charged states were used and how they compare. The second graphs shows
this information for all timepoints as a peptide uptake curve.</p>
</div>
<div class="section level3">
<h3 id="sequence-data">Sequence data<a class="anchor" aria-label="anchor" href="#sequence-data"></a>
</h3>
<p>The ‘Sequence data’ tab can be used to reconstruct the sequence from
the uploaded data and shows the coverage and sequence length. This can
be used as a quick sanity check to confirm the correct sequence
information was used. This tab also provides peptide coverage plots. The
‘Coverage’ graph (@) gives a quick overview of which peptides were
identified, and which regions have no coverage. The ‘Position Frequency’
graph on this page shows for each residue how many peptides cover this
region, providing information on peptide redundancy.</p>
<p>[JHS: for my data the redundancy field is empty. ]</p>
<div class="float">
<img src="peptide_coverage-display_plot.png" alt="Peptide coverage for SecA WT"><div class="figcaption">Peptide coverage for SecA WT</div>
</div>
</div>
<div class="section level3">
<h3 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h3>
<p>The summary is a very convienent and quick way to generate a summary
report of the uploaded data, according to community recommendations .
The report can be exported in a variety of formats.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Weronika Puchala, Michal Burdukiewicz.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
