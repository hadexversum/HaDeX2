<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Data aggregation • HaDeX</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Data aggregation">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">HaDeX</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/data_input.html">Importing data</a></li>
    <li><a class="dropdown-item" href="../articles/datafiles.html">Calculations</a></li>
    <li><a class="dropdown-item" href="../articles/example.html">Example HDX-MS data analysis</a></li>
    <li><a class="dropdown-item" href="../articles/glossary.html">Glossary</a></li>
    <li><a class="dropdown-item" href="../articles/mass_comparison.html">Mass calculation</a></li>
    <li><a class="dropdown-item" href="../articles/quality_control.html">Quality control</a></li>
    <li><a class="dropdown-item" href="../articles/transformation.html">Data aggregation</a></li>
    <li><a class="dropdown-item" href="../articles/usage.html">Code usage</a></li>
    <li><a class="dropdown-item" href="../articles/version_comparison.html">Comparison between versions</a></li>
    <li><a class="dropdown-item" href="../articles/visualization.html">Data visualization</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Data aggregation</h1>
            
      

      <div class="d-none name"><code>transformation.Rmd</code></div>
    </div>

    
    
<p>The aggregation of the hydrogen-deuterium exchange experimental data
is complex. This article describes the process step by step for a better
understanding of the data transformation.</p>
<div class="section level2">
<h2 id="aggregation-of-the-data---visualization">Aggregation of the data - visualization<a class="anchor" aria-label="anchor" href="#aggregation-of-the-data---visualization"></a>
</h2>
<pre><code><span><span class="co">## [1] ""</span></span></code></pre>
<p>Let’s see how the data is transformed. We will use the example file
“KD_180110_CD160_HVEM.csv” from the HaDeX package and focus on just one
peptide - “LCKDRSGDCSPETSLKQLRLKRDPGIDGVGEISSQL” in the state “CD160”.
The measurement was made for time point 1 min.</p>
<p>Below is shown the original and not aggregated data for chosen
peptide.</p>
<pre><code><span><span class="co">##      Protein Start   End                             Sequence Modification</span></span>
<span><span class="co">##       &lt;char&gt; &lt;int&gt; &lt;int&gt;                               &lt;char&gt;       &lt;lgcl&gt;</span></span>
<span><span class="co">##  1: db_CD160    34    69 LCKDRSGDCSPETSLKQLRLKRDPGIDGVGEISSQL           NA</span></span>
<span><span class="co">##  2: db_CD160    34    69 LCKDRSGDCSPETSLKQLRLKRDPGIDGVGEISSQL           NA</span></span>
<span><span class="co">##  3: db_CD160    34    69 LCKDRSGDCSPETSLKQLRLKRDPGIDGVGEISSQL           NA</span></span>
<span><span class="co">##  4: db_CD160    34    69 LCKDRSGDCSPETSLKQLRLKRDPGIDGVGEISSQL           NA</span></span>
<span><span class="co">##  5: db_CD160    34    69 LCKDRSGDCSPETSLKQLRLKRDPGIDGVGEISSQL           NA</span></span>
<span><span class="co">##  6: db_CD160    34    69 LCKDRSGDCSPETSLKQLRLKRDPGIDGVGEISSQL           NA</span></span>
<span><span class="co">##  7: db_CD160    34    69 LCKDRSGDCSPETSLKQLRLKRDPGIDGVGEISSQL           NA</span></span>
<span><span class="co">##  8: db_CD160    34    69 LCKDRSGDCSPETSLKQLRLKRDPGIDGVGEISSQL           NA</span></span>
<span><span class="co">##  9: db_CD160    34    69 LCKDRSGDCSPETSLKQLRLKRDPGIDGVGEISSQL           NA</span></span>
<span><span class="co">## 10: db_CD160    34    69 LCKDRSGDCSPETSLKQLRLKRDPGIDGVGEISSQL           NA</span></span>
<span><span class="co">## 11: db_CD160    34    69 LCKDRSGDCSPETSLKQLRLKRDPGIDGVGEISSQL           NA</span></span>
<span><span class="co">## 12: db_CD160    34    69 LCKDRSGDCSPETSLKQLRLKRDPGIDGVGEISSQL           NA</span></span>
<span><span class="co">## 13: db_CD160    34    69 LCKDRSGDCSPETSLKQLRLKRDPGIDGVGEISSQL           NA</span></span>
<span><span class="co">## 14: db_CD160    34    69 LCKDRSGDCSPETSLKQLRLKRDPGIDGVGEISSQL           NA</span></span>
<span><span class="co">## 15: db_CD160    34    69 LCKDRSGDCSPETSLKQLRLKRDPGIDGVGEISSQL           NA</span></span>
<span><span class="co">## 16: db_CD160    34    69 LCKDRSGDCSPETSLKQLRLKRDPGIDGVGEISSQL           NA</span></span>
<span><span class="co">## 17: db_CD160    34    69 LCKDRSGDCSPETSLKQLRLKRDPGIDGVGEISSQL           NA</span></span>
<span><span class="co">## 18: db_CD160    34    69 LCKDRSGDCSPETSLKQLRLKRDPGIDGVGEISSQL           NA</span></span>
<span><span class="co">## 19: db_CD160    34    69 LCKDRSGDCSPETSLKQLRLKRDPGIDGVGEISSQL           NA</span></span>
<span><span class="co">## 20: db_CD160    34    69 LCKDRSGDCSPETSLKQLRLKRDPGIDGVGEISSQL           NA</span></span>
<span><span class="co">##      Protein Start   End                             Sequence Modification</span></span>
<span><span class="co">##     MaxUptake      MHP  State Exposure                    File     z   Inten</span></span>
<span><span class="co">##         &lt;num&gt;    &lt;num&gt; &lt;char&gt;    &lt;num&gt;                  &lt;char&gt; &lt;int&gt;   &lt;num&gt;</span></span>
<span><span class="co">##  1:        33 3900.991  CD160        1 KD_160530_CD160_1min_01     3  325032</span></span>
<span><span class="co">##  2:        33 3900.991  CD160        1 KD_160530_CD160_1min_01     4  753259</span></span>
<span><span class="co">##  3:        33 3900.991  CD160        1 KD_160530_CD160_1min_01     5 1340447</span></span>
<span><span class="co">##  4:        33 3900.991  CD160        1 KD_160530_CD160_1min_01     6 2076956</span></span>
<span><span class="co">##  5:        33 3900.991  CD160        1 KD_160530_CD160_1min_01     7  759271</span></span>
<span><span class="co">##  6:        33 3900.991  CD160        1 KD_160530_CD160_1min_02     3  239810</span></span>
<span><span class="co">##  7:        33 3900.991  CD160        1 KD_160530_CD160_1min_02     4  583325</span></span>
<span><span class="co">##  8:        33 3900.991  CD160        1 KD_160530_CD160_1min_02     5 1011160</span></span>
<span><span class="co">##  9:        33 3900.991  CD160        1 KD_160530_CD160_1min_02     6 1584254</span></span>
<span><span class="co">## 10:        33 3900.991  CD160        1 KD_160530_CD160_1min_02     7  600218</span></span>
<span><span class="co">## 11:        33 3900.991  CD160        1 KD_160530_CD160_1min_03     3  176788</span></span>
<span><span class="co">## 12:        33 3900.991  CD160        1 KD_160530_CD160_1min_03     4  402630</span></span>
<span><span class="co">## 13:        33 3900.991  CD160        1 KD_160530_CD160_1min_03     5  746309</span></span>
<span><span class="co">## 14:        33 3900.991  CD160        1 KD_160530_CD160_1min_03     6 1117344</span></span>
<span><span class="co">## 15:        33 3900.991  CD160        1 KD_160530_CD160_1min_03     7  397718</span></span>
<span><span class="co">## 16:        33 3900.991  CD160        1 KD_160530_CD160_1min_04     3  189258</span></span>
<span><span class="co">## 17:        33 3900.991  CD160        1 KD_160530_CD160_1min_04     4  441817</span></span>
<span><span class="co">## 18:        33 3900.991  CD160        1 KD_160530_CD160_1min_04     5  796722</span></span>
<span><span class="co">## 19:        33 3900.991  CD160        1 KD_160530_CD160_1min_04     6 1186263</span></span>
<span><span class="co">## 20:        33 3900.991  CD160        1 KD_160530_CD160_1min_04     7  451071</span></span>
<span><span class="co">##     MaxUptake      MHP  State Exposure                    File     z   Inten</span></span>
<span><span class="co">##        Center</span></span>
<span><span class="co">##         &lt;num&gt;</span></span>
<span><span class="co">##  1: 1307.8329</span></span>
<span><span class="co">##  2:  981.0960</span></span>
<span><span class="co">##  3:  785.0905</span></span>
<span><span class="co">##  4:  654.3858</span></span>
<span><span class="co">##  5:  561.0548</span></span>
<span><span class="co">##  6: 1307.7777</span></span>
<span><span class="co">##  7:  981.0817</span></span>
<span><span class="co">##  8:  785.0811</span></span>
<span><span class="co">##  9:  654.4194</span></span>
<span><span class="co">## 10:  561.0268</span></span>
<span><span class="co">## 11: 1307.8942</span></span>
<span><span class="co">## 12:  981.1597</span></span>
<span><span class="co">## 13:  785.0906</span></span>
<span><span class="co">## 14:  654.4344</span></span>
<span><span class="co">## 15:  561.0833</span></span>
<span><span class="co">## 16: 1307.8739</span></span>
<span><span class="co">## 17:  981.1656</span></span>
<span><span class="co">## 18:  785.1220</span></span>
<span><span class="co">## 19:  654.4411</span></span>
<span><span class="co">## 20:  561.0588</span></span>
<span><span class="co">##        Center</span></span></code></pre>
<p>As we can see from the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mi>i</mi><mi>l</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">File</annotation></semantics></math>
column, there are four replicates of the experiment. Each measurement of
a replicate provide values for different possible charge values for each
peptide. The result of a measurement is in column
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>r</mi></mrow><annotation encoding="application/x-tex">Center</annotation></semantics></math>
- this is a geometrical centroid of an isotopic envelope - the product
of the measurement from a mass spectrometer.</p>
<p>Let’s take a look for values for each replicate.</p>
<p><img src="transformation_files/figure-html/unnamed-chunk-3-1.png" class="r-plt" width="700"></p>
<p>The centroid values for different charge values are not useful. We
have to transform it to the mass values, according to an equation:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>g</mi><mi>g</mi><mi>M</mi><mi>a</mi><mi>s</mi><mi>s</mi><mo>=</mo><mi>z</mi><mo>*</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>C</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>r</mi><mo>−</mo><mi>p</mi><mi>r</mi><mi>o</mi><mi>t</mi><mi>o</mi><mi>n</mi><mi>M</mi><mi>a</mi><mi>s</mi><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex"> aggMass = z*(Center - protonMass)</annotation></semantics></math>
The results are shown below.</p>
<p><img src="transformation_files/figure-html/unnamed-chunk-4-1.png" class="r-plt" width="700"></p>
<p>This results are just for one repetition. We have four of them:</p>
<p><img src="transformation_files/figure-html/unnamed-chunk-5-1.png" class="r-plt" width="700"></p>
<p>Values from each replicate are aggregated into one value, using
weighted mean (with intensity value as weight):</p>
<p><img src="transformation_files/figure-html/unnamed-chunk-6-1.png" class="r-plt" width="700"></p>
<p>The results from replicates are aggregated into the final result
(mean), and the uncertainty (standard deviation of the mean) is
calculated.</p>
<p><img src="transformation_files/figure-html/unnamed-chunk-7-1.png" class="r-plt" width="700"></p>
<p>Now we have the mass value for chosen peptide in the chosen state,
measured in the chosen time point. This calculation is done for every
other peptide, and these values of mass and uncertainty are used in the
calculation of deuterium uptake, as described in the
<code><a href="../articles/datafiles.html">vignette("datafiles")</a></code> article.</p>
</div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Weronika Puchala, Michal Burdukiewicz.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
