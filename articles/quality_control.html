<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Quality control • HaDeX2</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Quality control">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">HaDeX2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/data_input.html">Importing data</a></li>
    <li><a class="dropdown-item" href="../articles/datafiles.html">Calculations</a></li>
    <li><a class="dropdown-item" href="../articles/example.html">Example HDX-MS data analysis</a></li>
    <li><a class="dropdown-item" href="../articles/glossary.html">Glossary</a></li>
    <li><a class="dropdown-item" href="../articles/mass_comparison.html">Mass calculation</a></li>
    <li><a class="dropdown-item" href="../articles/quality_control.html">Quality control</a></li>
    <li><a class="dropdown-item" href="../articles/statistics.html">Statistics</a></li>
    <li><a class="dropdown-item" href="../articles/transformation.html">Data aggregation</a></li>
    <li><a class="dropdown-item" href="../articles/usage.html">Code usage</a></li>
    <li><a class="dropdown-item" href="../articles/version_comparison.html">Comparison between versions</a></li>
    <li><a class="dropdown-item" href="../articles/visualization.html">Data visualization</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Quality control</h1>
            
      

      <div class="d-none name"><code>quality_control.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://hadexversum.github.io/HaDeX2/">HaDeX2</a></span><span class="op">)</span></span></code></pre></div>
<p>Data analysis is vital step, but firstly, we must make sure that the
experiment was conducted correctly. How to do that using HaDeX
functionalities? There are multiple ways to do that. Unfortunately, our
example data is good quality, but we will discuss possible indicators of
data that needs to be re-checked.</p>
<div class="section level2">
<h2 id="replicates">Replicates<a class="anchor" aria-label="anchor" href="#replicates"></a>
</h2>
<p>Firstly, we check the number of replicates. Although the experiment
is conducted in known number of times, sometimes during the manual
curation of isotopic envelopes, some of the spectras are disqualified.
Here, we check the remaining number of replicates of the already curated
dataset.</p>
<p>It is advised to have at least three replicates of the experiment.
Lesser number limits the statistical analysis - e.q. for calculating
P-value using T-student test minimum of three replicates are needed. If
there are only two replicates, the uncertainty can be calculated.</p>
<p>In the example plot below, we see that there are three peptides in
this state that are lacking values. One peptide - with considerably lack
of replicates potentially should be eliminated from the peptide pool.
Majority of peptides have a stable number of replicates - in this case
three, with exception of no-deuterated control sample, measured only
once.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rep_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_replicate_dataset.html">create_replicate_dataset</a></span><span class="op">(</span><span class="va">alpha_dat</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_replicate_histogram.html">plot_replicate_histogram</a></span><span class="op">(</span><span class="va">rep_dat</span><span class="op">)</span></span></code></pre></div>
<p><img src="quality_control_files/figure-html/unnamed-chunk-2-1.png" class="r-plt" width="672"></p>
</div>
<div class="section level2">
<h2 id="uncertainty">Uncertainty<a class="anchor" aria-label="anchor" href="#uncertainty"></a>
</h2>
<p>Uncertainty plot presents the uncertainty of the measurement for one
state at the time. In this case, we present the time points separately.
There is no uncertainty calculated for time point 0 min, as it is
treated as undeuterated control and measured only once. For other time
points, as the measurement was conducted in triplicate, there are values
for measured mass. As the measured mass is in daltons, also the
uncertainty is presented in daltons. Thus, we can establish a threshold
of 1 dalton - indicating one exchange between proton and deuter. Any
uncertainty exceeding - or coming close - to this threshold should be
carefully checked.</p>
<p>For correctly conducted experiment, the uncertainty for all peptides
in all time points should be close to 0.</p>
<p>In the example below, all measurement have acceptable level of
uncertainty. Of course, those values differ depending on the region or
peptide length, but overall are not exceeding 0.25 Da.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_uncertainty.html">plot_uncertainty</a></span><span class="op">(</span><span class="va">alpha_dat</span>, state <span class="op">=</span> <span class="st">"Alpha_KSCN"</span><span class="op">)</span></span></code></pre></div>
<p><img src="quality_control_files/figure-html/unnamed-chunk-3-1.png" class="r-plt" width="672"></p>
</div>
<div class="section level2">
<h2 id="measurements">Measurements<a class="anchor" aria-label="anchor" href="#measurements"></a>
</h2>
<p>Once we have the overview of the situation, we can dig deeper into
the peptides of interest.</p>
<p>Below, we present the measurement variability plot for peptide
“GDGDLKSPAGL” in one state, for three replicates.The process of two-step
aggregation is described in the article <code>transformation</code>, but
this plot allows investigation of each measurement.</p>
<p>Here, in case of peptide “GDGDLKSPAGL”, there were only two possible
charge values: 1 and 2. The mass was measured for each of them
separately, and the centroid value from isotopic envelope was
calculated, as well as the appropriate intensity. On the Y axis of the
plot, there are replicates: and each replicate has its two points for
each charge - with colors indicating charge and size indicating
intensity. Then, those two values within replicate are aggregated - as a
weighted mean, with intensity being the weight. For each replicate we
have now one value - black dot. Those values are averaged with
accompanied standard deviation - our final aggregated mass measurement
from all the replicates. The final value is shown as the horizontal
dotted line, with its sd value indicated by the red area.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_peptide_mass_measurement.html">plot_peptide_mass_measurement</a></span><span class="op">(</span><span class="va">alpha_dat</span><span class="op">)</span></span></code></pre></div>
<p><img src="quality_control_files/figure-html/unnamed-chunk-4-1.png" class="r-plt" width="672"></p>
<p>The peptide recognized as under-measured using previous plot, is
peptide “CVRSIQA” in state
eEF1B<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>γ</mi><annotation encoding="application/x-tex">\gamma</annotation></semantics></math>.
We analyze the mass uptake with regards to replicates (aggregated
charge) and we see that for time point 25 min only one measurement was
accepted, and for other time points two, thus blocking the possibility
of calculating statistical significance when using this peptide in
comparative analysis.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_replicate_mass_uptake.html">plot_replicate_mass_uptake</a></span><span class="op">(</span><span class="va">alpha_dat</span>, sequence <span class="op">=</span> <span class="st">"CVRSIQA"</span>, aggregated <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="quality_control_files/figure-html/unnamed-chunk-5-1.png" class="r-plt" width="672"></p>
</div>
<div class="section level2">
<h2 id="back-exchange">Back-exchange<a class="anchor" aria-label="anchor" href="#back-exchange"></a>
</h2>
<p>Important measure of quality of experiment is back-exchange. Usually,
expected value of back-exchange should be around 30%, possibly higher
for shorter peptides.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bex_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_back_exchange.html">calculate_back_exchange</a></span><span class="op">(</span><span class="va">alpha_dat</span>, state <span class="op">=</span> <span class="st">"Alpha_KSCN"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_coverage_heatmap.html">plot_coverage_heatmap</a></span><span class="op">(</span><span class="va">bex_dat</span>, value <span class="op">=</span> <span class="st">"back_exchange"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Ignoring unknown labels:</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> <span style="color: #00BB00;">colour</span> : <span style="color: #0000BB;">"Exposure"</span></span></span></code></pre></div>
<p><img src="quality_control_files/figure-html/unnamed-chunk-6-1.png" class="r-plt" width="672"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Weronika Puchala, Michal Burdukiewicz.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
