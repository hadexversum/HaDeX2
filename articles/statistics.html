<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Statistics • HaDeX2</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Statistics">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">HaDeX2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/data_input.html">Importing data</a></li>
    <li><a class="dropdown-item" href="../articles/datafiles.html">Calculations</a></li>
    <li><a class="dropdown-item" href="../articles/example.html">Example HDX-MS data analysis</a></li>
    <li><a class="dropdown-item" href="../articles/glossary.html">Glossary</a></li>
    <li><a class="dropdown-item" href="../articles/mass_comparison.html">Mass calculation</a></li>
    <li><a class="dropdown-item" href="../articles/quality_control.html">Quality control</a></li>
    <li><a class="dropdown-item" href="../articles/statistics.html">Statistics</a></li>
    <li><a class="dropdown-item" href="../articles/transformation.html">Data aggregation</a></li>
    <li><a class="dropdown-item" href="../articles/usage.html">Code usage</a></li>
    <li><a class="dropdown-item" href="../articles/version_comparison.html">Comparison between versions</a></li>
    <li><a class="dropdown-item" href="../articles/visualization.html">Data visualization</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Statistics</h1>
            
      

      <div class="d-none name"><code>statistics.Rmd</code></div>
    </div>

    
    
<p>Here, we sum up the statistics in HaDeX2. Some of the elements are discussed in other articles in appropriate places, but this article gathers this information in one place.</p>
<div class="section level2" number="1">
<h2 id="uncertainty-propagation">
<span class="header-section-number">1</span> Uncertainty propagation<a class="anchor" aria-label="anchor" href="#uncertainty-propagation"></a>
</h2>
<p>The propagation of uncertainty <span class="citation">(Puchała et al. 2020; Weis 2021)</span> is necessary when we are transforming the measured values. In HDX-MS, we repeat the measurements in triplicate in order to calculate the uncertainty of mass measurement. However, when transforming mass measurements into deuterium uptake, we need to propagate mass measurement uncertainty, using the Law of Propagation of Uncertainty <span class="citation">(Joint Committee for Guides in Metrology 2008)</span>:</p>
<p><span class="math display">\[u_{c}(y) = \sqrt{\sum_{k} \left[ \frac{\partial y}{\partial x_{k}} u(x_{k}) \right]^2}\]</span></p>
<p>Where:</p>
<ul>
<li>
<span class="math inline">\(u_c(y)\)</span> - combined uncertainty of value <span class="math inline">\(y\)</span>, where <span class="math inline">\(y\)</span> is a function of <span class="math inline">\(x_k\)</span>,</li>
<li>
<span class="math inline">\(x_k\)</span> - values for which the uncertainty is known.</li>
</ul>
<p>This is a generic equation used for the propagation of uncertainty in functions of multiple variables. It is instantiated for deuterium uptake in its appropriate formulations, as the specific expressions differ depending on the parameters of the calculation, and is described in detail in the dedicated subsection @ref(#unc).</p>
</div>
<div class="section level2" number="2">
<h2 id="hybrid-testing">
<span class="header-section-number">2</span> Hybrid testing<a class="anchor" aria-label="anchor" href="#hybrid-testing"></a>
</h2>
<p>HaDeX offers the hybrid testing procedure <span class="citation">(Hageman and Weis 2019)</span> because it addressed the trade-off between false positives and loss of power in the analysis of HDX-MS data. The hybrid test applies a two-stage decision rule to identify significantly different deuterium uptakes. First, the observed difference in deuterium uptake must exceed a globally estimated uncertainty threshold derived from pooled experimental standard deviations, ensuring that the effect is larger than expected measurement error. Only differences passing this magnitude-based filter are then evaluated using a replicate-aware hypothesis test, implemented as a Welch’s t-test, to assess whether the observed difference is statistically supported given the individual variances. A difference is considered significant only when both criteria are satisfied simultaneously.</p>
<p>Although the hybrid test offers superior statistical power compared to more classical statistical approaches, it is more data-intensive and therefore can be performed only when the user provides the experiment with at least three experimental replicates.</p>
<div class="section level3" number="2.1">
<h3 id="houde">
<span class="header-section-number">2.1</span> Houde interval<a class="anchor" aria-label="anchor" href="#houde"></a>
</h3>
<p>This test is done for the time points chosen for a given plot e.q. for the volcano plot, where presenting multiple time points of measurement, we take the values from all of the presented time points. However, for Woods Plot we only take into account only one time point - presented on the plot.</p>
<p>Houde interval <span class="citation">(Houde, Berkowitz, and Engen 2011)</span> is calculated based on the uncertainty of the measurement - or, more precisely, the propagated uncertainty of the deuterium uptake (in the same form as values presented on the plot). As described in the equation:</p>
<p><span class="math display">\[interval = \frac{\sum_i^n u_c(du_n)}{i}*tvalue(k) \]</span>
where:</p>
<ul>
<li>
<span class="math inline">\(n\)</span> - number of peptides,</li>
<li>
<span class="math inline">\(u_c(du_n)\)</span> - uncertainty of the deuterium uptake for <span class="math inline">\(i\)</span>th peptide,</li>
<li>
<span class="math inline">\(tvalue\)</span> - value for test for <span class="math inline">\(k\)</span> replicates from the table,</li>
<li>
<span class="math inline">\(k\)</span> - number of the replicates of the experiment.</li>
</ul>
<p><span class="math inline">\(tvalue\)</span> is calculated as follows, using R-function <code>qt</code>:</p>
<p><span class="math display">\[tvalue = qt(c(alpha/2, 1-alpha/2), df = k-1)\]</span></p>
<p>where the degree of freedom is the number of replicates minus one, and alpha is <span class="math inline">\(1-\textrm{confidence limit}\)</span> for the desired confidence level (usually 0.98).</p>
<p>Basically, we take the mean uncertainty of deuterium uptake and widen this range by the appropriate value to get an interval. Values under the interval are too small and may be mistaken with the uncertainty. We are not interested in them.</p>
</div>
<div class="section level3" number="2.2">
<h3 id="students-t-test">
<span class="header-section-number">2.2</span> Student’s t-test<a class="anchor" aria-label="anchor" href="#students-t-test"></a>
</h3>
<p>In order to use student t-test, we need at least three values from each group - in the case of the differential analysis - at least three replicate values at given time for each biological state.</p>
<p>This test shows us if the values are from two different distributions (desired option) or from one - and are the same. We are not interested in the latter case.</p>
<p>We use the unpaired Student’s t-test to calculate p-value. The null hypothesis is that this two distributions are the same. If calculated p-value exceeded limit set for chosen confidence limit, we reject the null hypothesis and assume that the distributions are different.</p>
<p>To calculate p-value we use base R-function <code>t.test</code></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">st_1</span>, y <span class="op">=</span> <span class="va">st_2</span>, </span>
<span>       paired <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>       alternative <span class="op">=</span> <span class="st">"two.sided"</span>, </span>
<span>       conf.level <span class="op">=</span> <span class="va">confidence_level</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span></span></code></pre></div>
<p>where <span class="math inline">\(st_1\)</span> is a set of values from the first state, and <span class="math inline">\(st_2\)</span> from the second.</p>
<p>If this option is chosen, we adjust the p-value using appropriate adjustment method (with three options: ‘none’, ‘BH’ and ‘bonferroni’):</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust</a></span><span class="op">(</span><span class="va">p_dat</span><span class="op">[[</span><span class="st">"P_value"</span><span class="op">]</span><span class="op">]</span>, method <span class="op">=</span> <span class="va">p_adjustment_method</span><span class="op">)</span></span></code></pre></div>
<p>p-value is usually presented in the form of <span class="math inline">\(-log(\textrm{p-value})\)</span>, e.g. on the volcano plot.</p>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-hageman_reliable_2019" class="csl-entry">
Hageman, Tyler S., and David D. Weis. 2019. <span>“Reliable <span>Identification</span> of <span>Significant</span> <span>Differences</span> in <span>Differential</span> <span>Hydrogen</span> <span>Exchange</span>-<span>Mass</span> <span>Spectrometry</span> <span>Measurements</span> <span>Using</span> a <span>Hybrid</span> <span>Significance</span> <span>Testing</span> <span>Approach</span>.”</span> <em>Analytical Chemistry</em> 91 (13): 8008–16. <a href="https://doi.org/10.1021/acs.analchem.9b01325" class="external-link">https://doi.org/10.1021/acs.analchem.9b01325</a>.
</div>
<div id="ref-houde_utility_2011" class="csl-entry">
Houde, Damian, Steven A. Berkowitz, and John R. Engen. 2011. <span>“The Utility of Hydrogen/Deuterium Exchange Mass Spectrometry in Biopharmaceutical Comparability Studies.”</span> <em>Journal of Pharmaceutical Sciences</em> 100 (6): 2071–86. <a href="https://doi.org/10.1002/jps.22432" class="external-link">https://doi.org/10.1002/jps.22432</a>.
</div>
<div id="ref-JCGM2008GUM" class="csl-entry">
Joint Committee for Guides in Metrology. 2008. <span>“<span>JCGM 100:2008</span> <span class="nocase">Evaluation of Measurement Data — Guide to the Expression of Uncertainty in Measurement</span>.”</span> Technical Report JCGM 100:2008. Joint Committee for Guides in Metrology.
</div>
<div id="ref-puchala_hadex_2020" class="csl-entry">
Puchała, Weronika, Michał Burdukiewicz, Michał Kistowski, Katarzyna A. Dąbrowska, Aleksandra E. Badaczewska-Dawid, Dominik Cysewski, and Michał Dadlez. 2020. <span>“<span>HaDeX</span>: An <span>R</span> Package and Web-Server for Analysis of Data from Hydrogen-Deuterium Exchange Mass Spectrometry Experiments.”</span> <em>Bioinformatics (Oxford, England)</em> 36 (16): 4516–18. <a href="https://doi.org/10.1093/bioinformatics/btaa587" class="external-link">https://doi.org/10.1093/bioinformatics/btaa587</a>.
</div>
<div id="ref-weis_recommendations_2021" class="csl-entry">
Weis, David D. 2021. <span>“Recommendations for the <span>Propagation</span> of <span>Uncertainty</span> in <span>Hydrogen</span> <span>Exchange</span>-<span>Mass</span> <span>Spectrometric</span> <span>Measurements</span>.”</span> <em>Journal of the American Society for Mass Spectrometry</em> 32 (7): 1610–17. <a href="https://doi.org/10.1021/jasms.0c00475" class="external-link">https://doi.org/10.1021/jasms.0c00475</a>.
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Weronika Puchala, Michal Burdukiewicz.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
